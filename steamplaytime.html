<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Nate Collings</title>
  <link href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/app.css"/>
  <link rel="stylesheet" type="text/css" href="http://realcess.appspot.com/css/agpzfnJlYWxjZXNzchELEgRQYWdlGICAgICAuYQJDA" />
  <script type="text/javascript">(function(w,d){if(w.location!=w.parent.location||w.location.search.indexOf('__preview_css__')>-1){var t=d.createElement('script');t.type='text/javascript';t.async=true;t.src='http://realcess.appspot.com/js/agpzfnJlYWxjZXNzchELEgRQYWdlGICAgICAuYQJDA';(d.body||d.documentElement).appendChild(t);}})(window,document);</script>
  
</head>
<body>
	<div class="container">
		<div id="header">
			<h1><a href="index.html">Nate Collings</a></h1>
		</div>
		<div class="clear"></div>
		<hr>

		<a class="btn btn-large btn-info nounder" href="https://steamplaytime.appspot.com">Click here to visit Steamplaytime</a>
		<br>
		<br>
		<ul>
			<li><a href="https://github.com/naiyt/steamplaytime">Steamplaytime source</a></li>
		</ul>
		<hr>
		<p>Here's an app that was particularly fun to make (and ended up being a lot more popular then I expected).</p>

		<h3>The Idea</h3>
		<hr>

		<p>Here's the basic premise:
			<ul>
				<li>Steam has great and frequent sales</li>
				<li>People impulsively purchase games off of Steam because of this</li>
				<li>Therefore, people have huge Steam libraries with games they may never play</li>
			</ul>
			
			There are already tools out there that will estimate the dollar worth of your Steam library -- but I had never seen one that would estimate the number of hours of gameplay contained within it. My thought process was that if there was, perhaps people (including myself) would be more apt to stop purchasing so many games that they will never play if they realized that there is literally not enough hours in their life to play the games they already own!
	
		</p>

		<p>I had already messed around with the Steam Web API on creating a seperate Steam related app that never panned out (or at least hasn't panned out yet). So I had the idea pop into my head on a Friday afternoon, and spent the weekend hacking it together.</p>

		<h3>Scaling</h3>
		<hr>

		<p>After whipping it together, I posted it on a few online forums. Within a day it had been posted on NeoGAF, Reddit, PCGamesN, the Steam Forums, CheapAssGamer, had been tweeted by a few popular users, and had spread to a bunch of smaller forums.</p>

		<p>All in all, it received approxiametely 20,000 pageviews within the first day, with nearly 10,000 unique Steam IDs queried. Which was probably about 19,000 more pageviews then I was expecting. A huge majority of those first visits came from <a href="http://www.pcgamesn.com/calculate-damage-your-steam-backlog-steamplaytime">this post on PCGamesN</a>.</p>

		<p>I bring this up not to brag (since it really wasn't that impressive of an idea, I swear), but to highlight some pretty awesome properties of the Google App Engine. As someone who worked in tech support for a webhosting company I know the absolute hell that comes from a product release, and scaling to meet higher then expected demands. It's generally an absolute nightmare for all those involved.</p>

		<p>But thanks to Google App Engine's autoscaling, everything worked flawlessly, even when I had upwards of 300 concurrent users at several points in the day.  After the many nightmares I had seen with botched releases while working in webhosting, it nearly put a tear in my eye. Google would just spin me up a new instance whenever needed, and I didn't have to worry about a thing.</p>

		<p>...well, that's somewhat of a lie. I certainly had to worry about the <em>price!</em>. Running a high traffic app on GAE can cost you quite a bit. Especially if your app's datastore queries are not optimized and properly cached, and if your code is inefficient (leading to more instance hours required). I kept watching my allocated instance hours creep up to their limit, and my datastore queries jump higher and higher throughout the day. I didn't really have a lot of money to pour into the app, so I kept bumping up my max daily limit hoping that I wouldn't go over.</p>

		<p>Luckily, the majority of the traffic was just in the first couple of days. It cost around $15 to run it for the first three days. Since then, I've optimized a lot of things, and it only gets about a hundred or so hits on average a day now, so it barely costs me anything anymore.</p>

		<p>Speaking of caching, <a href="https://developers.google.com/appengine/docs/python/ndb/">NDB is pretty awesome</a>. If anybody is still using GAE's old db API, they should switch to NDB as soon as possible. NDB automatically caches EVERY datastore entity in memcache. You don't have to worry about manually caching any of your datastore queries, which is incredidbly helpful. It certainly made my code shorter and more bug free, and the performance benefits are fantastic. I get about an 83% memcache hit rate, without any effort on my part.</p>


		<h3>The Code</h3>
		<hr>
		
		<p>
			The basic needs for the app are:
			<ul>
				<li>Gather the user's Steam information (games owned, hours played on each game)</li>
				<li>Compare the user's playtime to our estimated required playtimes</li>
				<li>Make an educated guess of what games they have and haven't beaten, and provide the user with these stats.</li>
			</ul>
		</p>

		<p>The code for Steamplaytime is pretty straightforward. There are definitely some improvements/refactoring needed (especially on my nasty session handling I wrote -- yuck). And as per the previous section, it's had no problems scaling to a much larger number of users then I expected.</p>

		<p>To estimate how many hours it would take to finish a game, I currently borrow numbers from <a href="http://howlongtobeat.com">HowLongToBeat</a>. Due to the structure of their site, I've had a bit of trouble just scraping the info, so I wrote a small Hotkey script that sort of does it manually. Not ideal at all -- however, I'm not really planning on changing that implementation as of now. More info on that in a bit.</p>

		<p>Interacting with the Steam API is pretty simple, as I already had a <a href="steamapi.html">Steam API wrapper written</a> for that other probject that died. Writing that was a tad tricky, as the Steam Web API's documentation is really nasty.</p>

		<p>Pretty much everything was initially done server side. However, I recently added the ability for users to sign in with their Steam accounts and manully manage their games. This is done with <a href="http://jqueryui.com/sortable/">ui-sortable</a>, which works fine for the most part.</p>

		<p>I'm not super proud of the quality of the code, as it was put together fairly quickly on a weekend. When I have more time I'll likely refactor a lot of the code (especially since there's a few reamining bus).</p>
	</div>
</body>
</html>
</html>